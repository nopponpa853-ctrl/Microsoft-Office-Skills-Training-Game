<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏Å‡∏°‡∏ù‡∏∂‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Microsoft Office</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* --- 1. SETTING & THEME (‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°) --- */
        :root {
            --primary: #00f2ff; /* ‡∏™‡∏µ‡∏ô‡∏µ‡∏≠‡∏≠‡∏ô‡∏ü‡πâ‡∏≤ */
            --secondary: #bc13fe; /* ‡∏™‡∏µ‡∏ô‡∏µ‡∏≠‡∏≠‡∏ô‡∏°‡πà‡∏ß‡∏á */
            --bg-dark: #0a0a12;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Prompt', sans-serif; }

        body {
            /* [‡πÇ‡∏ô‡πä‡∏ï: ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ‡∏ï‡∏£‡∏á url(...)] */
            background: url('https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=2070') no-repeat center center/cover;
            background-attachment: fixed;
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Overlay ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏°‡∏∑‡∏î‡∏•‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏î‡πà‡∏ô */
        body::before {
            content: ''; position: fixed; inset: 0;
            background: linear-gradient(to bottom, rgba(10,10,18,0.8), rgba(10,10,18,0.95));
            z-index: -1;
        }

        /* --- 2. HEADER & MENU (‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏ô‡∏π 3 ‡∏à‡∏∏‡∏î) --- */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 5%; height: 80px;
            background: rgba(10, 10, 18, 0.6); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
            position: fixed; top: 0; width: 100%; z-index: 1000;
        }

        .logo { font-size: 1.5rem; font-weight: 700; background: linear-gradient(45deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 0 10px rgba(0,242,255,0.3); }
        
        .menu-dots { font-size: 1.8rem; cursor: pointer; color: var(--primary); transition: 0.3s; }
        .menu-dots:hover { transform: scale(1.1); text-shadow: 0 0 10px var(--primary); }

        /* Popup Menu ‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô */
        .popup-menu {
            position: fixed; top: 85px; right: 20px;
            background: rgba(20, 20, 35, 0.95);
            border: 1px solid var(--primary);
            border-radius: 15px; padding: 15px;
            width: 250px; display: none; flex-direction: column; gap: 10px;
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.2);
            z-index: 999;
            backdrop-filter: blur(15px);
        }
        .popup-menu.active { display: flex; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .menu-item {
            padding: 12px; border-radius: 8px; cursor: pointer;
            background: rgba(255,255,255,0.05); transition: 0.3s;
            display: flex; align-items: center; gap: 10px;
        }
        .menu-item:hover { background: var(--primary); color: #000; }

        /* --- 3. MAIN CONTENT (‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°) --- */
        main { padding: 100px 20px 40px; max-width: 1200px; margin: 0 auto; text-align: center; }
        
        .hero-text { margin-bottom: 40px; }
        .hero-text h1 { font-size: 2.5rem; margin-bottom: 10px; }

        .program-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px;
        }

        .program-card {
            background: var(--glass); border: 1px solid var(--glass-border);
            border-radius: 20px; padding: 30px; cursor: pointer;
            transition: 0.4s; position: relative; overflow: hidden;
            height: 350px; display: flex; flex-direction: column; justify-content: flex-end;
        }
        
        /* [‡πÇ‡∏ô‡πä‡∏ï: ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ Word, Excel, PPT ‡∏ï‡∏£‡∏á background-image ‡πÉ‡∏ô html ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á] */
        .program-card::before {
            content: ''; position: absolute; inset: 0;
            background-size: cover; background-position: center;
            opacity: 0.6; transition: 0.4s; z-index: -1;
        }
        .program-card:hover { transform: translateY(-10px); box-shadow: 0 0 30px var(--secondary); }
        .program-card:hover::before { opacity: 0.3; transform: scale(1.1); }
        .program-card h2 { font-size: 2rem; z-index: 2; text-align: left; text-shadow: 0 2px 5px black; }

        /* --- 4. GAME UI (‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°) --- */
        #game-area { display: none; padding-top: 100px; }
        .game-container {
            background: rgba(20, 20, 35, 0.9); border: 1px solid var(--secondary);
            border-radius: 20px; padding: 30px; max-width: 800px; margin: 0 auto;
            box-shadow: 0 0 50px rgba(188, 19, 254, 0.2);
        }
        .hud { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 1.2rem; color: var(--primary); }
        
        /* Game 1: Typing */
        .word-display { font-size: 3rem; margin: 40px 0; letter-spacing: 5px; color: #fff; text-shadow: 0 0 10px var(--secondary); }
        .missing-char { color: var(--primary); text-decoration: underline; }
        input.answer-input { 
            background: transparent; border: 2px solid var(--primary); color: #fff; 
            font-size: 1.5rem; padding: 10px; text-align: center; border-radius: 10px; outline: none; 
        }

        /* Game 2: Quiz */
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px; }
        .option-btn {
            background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border);
            padding: 15px; border-radius: 10px; color: #fff; cursor: pointer; transition: 0.3s;
            font-size: 1.1rem;
        }
        .option-btn:hover { background: var(--secondary); border-color: var(--secondary); }

        /* Game 3: Matching */
        .matching-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .match-item { 
            background: #2a2a40; padding: 15px; border-radius: 8px; cursor: pointer; 
            border: 2px solid transparent; text-align: center;
        }
        .match-item.selected { border-color: var(--primary); box-shadow: 0 0 15px var(--primary); }
        .match-item.matched { background: #4caf50; opacity: 0.5; pointer-events: none; }

        /* Game 4: Ordering */
        .order-list { list-style: none; margin-top: 20px; text-align: left; }
        .order-item { 
            background: rgba(255,255,255,0.1); padding: 10px; margin-bottom: 5px; 
            border-radius: 5px; cursor: pointer; display: flex; justify-content: space-between;
        }
        .order-item:hover { background: rgba(255,255,255,0.2); }

        /* --- 5. FOOTER & MODALS --- */
        footer {
            margin-top: 50px; padding: 20px; background: rgba(0,0,0,0.8);
            text-align: center; font-size: 0.9rem; color: #aaa; border-top: 1px solid #333;
        }

        /* Modal Design */
        .modal {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            z-index: 2000; justify-content: center; align-items: center;
        }
        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            padding: 30px; border-radius: 20px; border: 1px solid var(--primary);
            width: 90%; max-width: 450px; text-align: center; position: relative;
            box-shadow: 0 0 30px rgba(0,242,255,0.2);
        }
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 1.5rem; cursor: pointer; }
        .modal input {
            width: 100%; padding: 12px; margin: 10px 0; background: rgba(0,0,0,0.3);
            border: 1px solid var(--glass-border); border-radius: 8px; color: #fff;
        }
        .btn-neon {
            width: 100%; padding: 12px; margin-top: 10px; border: none; border-radius: 8px;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            color: #fff; font-weight: bold; cursor: pointer; font-size: 1rem;
            box-shadow: 0 0 15px rgba(188,19,254,0.4); transition: 0.3s;
        }
        .btn-neon:hover { transform: scale(1.02); box-shadow: 0 0 25px rgba(0,242,255,0.6); }

        /* History Table */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; color: #fff; }
        th, td { padding: 10px; border-bottom: 1px solid #444; text-align: left; font-size: 0.9rem; }
        th { color: var(--primary); }

        /* Responsive */
        @media (max-width: 768px) {
            .program-grid { grid-template-columns: 1fr; }
            .word-display { font-size: 2rem; }
            .options-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo"><i class="fas fa-gamepad"></i> Office Skills</div>
        <div class="menu-dots" onclick="toggleMenu()"><i class="fas fa-ellipsis-v"></i></div>
    </header>

    <div class="popup-menu" id="sideMenu">
        <div class="menu-item" onclick="openModal('registerModal')"><i class="fas fa-user-plus"></i> ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
        <div class="menu-item" onclick="openHistory()"><i class="fas fa-history"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</div>
        <div class="menu-item" onclick="openDev()"><i class="fas fa-code"></i> ‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏°</div>
        <div class="menu-item" onclick="logout()" style="color: #ff4d4d;"><i class="fas fa-sign-out-alt"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</div>
    </div>

    <main id="home">
        <div class="hero-text">
            <h1>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å</h1>
            <p>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡πÇ‡∏•‡∏Å‡πÅ‡∏´‡πà‡∏á Microsoft Office Challenge!</p>
        </div>
        <div class="program-grid">
            <div class="program-card" onclick="selectProgram('Word')" style="background: url('https://images.unsplash.com/photo-1585435557343-3b092031a831?w=500') center/cover;">
                <div style="background:rgba(0,0,0,0.5); position:absolute; inset:0;"></div>
                <h2>Word</h2>
            </div>
            <div class="program-card" onclick="selectProgram('Excel')" style="background: url('https://images.unsplash.com/photo-1543269865-cbf427effbad?w=500') center/cover;">
                <div style="background:rgba(0,0,0,0.5); position:absolute; inset:0;"></div>
                <h2>Excel</h2>
            </div>
            <div class="program-card" onclick="selectProgram('PowerPoint')" style="background: url('https://images.unsplash.com/photo-1586717791821-3f44a5638d48?w=500') center/cover;">
                <div style="background:rgba(0,0,0,0.5); position:absolute; inset:0;"></div>
                <h2>PowerPoint</h2>
            </div>
        </div>
    </main>

    <section id="game-area">
        <div class="game-container">
            <div class="hud">
                <span id="hud-level">Level: 1</span>
                <span id="hud-timer">Time: 60s</span>
                <span id="hud-score">Score: 0</span>
            </div>
            <div id="game-content">
                </div>
            <button class="btn-neon" id="next-btn" style="margin-top:20px; display:none;" onclick="nextLevel()">‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
    </section>

    <footer>
        <p>‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à & ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</p>
    </footer>

    <div class="modal" id="registerModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('registerModal')">&times;</span>
            <h2><i class="fas fa-user-plus"></i> ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
            <input type="email" id="reg-email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
            <input type="text" id="reg-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠">
            <input type="password" id="reg-pass" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            <button class="btn-neon" onclick="register()">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
        </div>
    </div>

    <div class="modal" id="historyModal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-modal" onclick="closeModal('historyModal')">&times;</span>
            <h2><i class="fas fa-history"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>
            <table>
                <thead><tr><th>‡πÄ‡∏Å‡∏°</th><th>‡∏î‡πà‡∏≤‡∏ô</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th></tr></thead>
                <tbody id="history-list"></tbody>
            </table>
        </div>
    </div>

    <div class="modal" id="devModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('devModal')">&times;</span>
            <h2><i class="fas fa-code"></i> ‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏°</h2>
            <div style="margin-top: 20px; text-align: left; line-height: 1.8;">
                <p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏õ‡∏≤‡∏ô‡∏ï‡∏∞‡∏ß‡∏±‡∏ô ‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå</p>
                <p><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô:</strong> ‡∏ä‡∏Ñ‡∏û.3/1</p>
                <p><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</strong> 096-584-0062</p>
            </div>
        </div>
    </div>

    <div class="modal" id="introModal">
        <div class="modal-content">
            <h2 id="intro-title" style="color:var(--primary)">‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>
            <p id="intro-desc" style="margin: 15px 0; color: #ddd;"></p>
            <button class="btn-neon" onclick="startGameReal()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°!</button>
        </div>
    </div>

    <script>
        // --- DATA & CONTENT (‡∏Ñ‡∏•‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö) ---
        const gameData = {
            Word: {
                game1: [ // ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏®‡∏±‡∏û‡∏ó‡πå
                    { q: "MA_GIN", a: "R", full: "MARGIN", hint: "‡∏Ç‡∏≠‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©" },
                    { q: "FO_T", a: "N", full: "FONT", hint: "‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£" },
                    { q: "TAB_E", a: "L", full: "TABLE", hint: "‡∏ï‡∏≤‡∏£‡∏≤‡∏á" },
                    { q: "INSE_T", a: "R", full: "INSERT", hint: "‡πÅ‡∏ó‡∏£‡∏Å" },
                    { q: "LA_OUT", a: "Y", full: "LAYOUT", hint: "‡πÄ‡∏Ñ‡πâ‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á" }
                ],
                game2: [ // ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
                    { q: "‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å (Copy)?", opts: ["Ctrl+C", "Ctrl+V", "Ctrl+X", "Ctrl+P"], ans: 0 },
                    { q: "‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏î?", opts: ["Ctrl+B", "Ctrl+I", "Ctrl+U", "Ctrl+S"], ans: 0 },
                    { q: "‡πÅ‡∏ñ‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£?", opts: ["Home", "Insert", "Layout", "View"], ans: 0 },
                    { q: "‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Word ‡∏Ñ‡∏∑‡∏≠?", opts: [".docx", ".xlsx", ".pptx", ".pdf"], ans: 0 },
                    { q: "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Save ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏î?", opts: ["File", "Home", "Insert", "Design"], ans: 0 },
                    { q: "Ctrl+Z ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏≠‡∏∞‡πÑ‡∏£?", opts: ["Undo", "Redo", "Cut", "Paste"], ans: 0 },
                    { q: "‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏î?", opts: ["Ctrl+E", "Ctrl+L", "Ctrl+R", "Ctrl+J"], ans: 0 },
                    { q: "‡πÑ‡∏°‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î (Ruler) ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£?", opts: ["‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏±‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤-‡∏´‡∏•‡∏±‡∏á", "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ", "‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ", "‡∏•‡∏ö‡∏Ñ‡∏≥"], ans: 0 }
                ],
                game3: [ // ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà (‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°/‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô)
                    { pairs: [{id:1, txt:"Save"}, {id:1, txt:"üíæ"}, {id:2, txt:"Print"}, {id:2, txt:"üñ®Ô∏è"}, {id:3, txt:"Cut"}, {id:3, txt:"‚úÇÔ∏è"}] },
                    { pairs: [{id:1, txt:"Bold"}, {id:1, txt:"‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤"}, {id:2, txt:"Italic"}, {id:2, txt:"‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏µ‡∏¢‡∏á"}, {id:3, txt:"Underline"}, {id:3, txt:"‡∏Ç‡∏µ‡∏î‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ"}] },
                    { pairs: [{id:1, txt:".docx"}, {id:1, txt:"Word"}, {id:2, txt:".pdf"}, {id:2, txt:"Acrobat"}, {id:3, txt:".txt"}, {id:3, txt:"Notepad"}] }
                ],
                game4: [ // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö
                    { q: "‡∏à‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà", items: ["‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Word", "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π File", "‡∏Å‡∏î New", "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Blank Document"] },
                    { q: "‡∏à‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å", items: ["‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Save", "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Browse", "‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå", "‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Save"] },
                    { q: "‡∏à‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏£‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û", items: ["‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π Insert", "‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Pictures", "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡∏Å‡∏î Insert"] }
                ]
            },
            // *‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: Excel ‡πÅ‡∏•‡∏∞ PowerPoint ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (Copy Word ‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)*
            Excel: { game1: [], game2: [], game3: [], game4: [] }, // ‡∏¢‡πà‡∏≠‡πÑ‡∏ß‡πâ
            PowerPoint: { game1: [], game2: [], game3: [], game4: [] }
        };

        // Mock Data for Excel/PPT (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á ‡∏à‡∏∞ Duplicate ‡∏à‡∏≤‡∏Å Word ‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô)
        gameData.Excel = JSON.parse(JSON.stringify(gameData.Word));
        gameData.PowerPoint = JSON.parse(JSON.stringify(gameData.Word));

        // --- SYSTEM VARIABLES ---
        let currentUser = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null;
        let currentGame = { category: '', type: 1, level: 1, score: 0, questionIndex: 0, timer: 0, interval: null };
        let history = localStorage.getItem('history') ? JSON.parse(localStorage.getItem('history')) : [];

        // --- FUNCTIONS ---

        // 1. Menu & Auth
        function toggleMenu() { document.getElementById('sideMenu').classList.toggle('active'); }
        function openModal(id) { 
            document.getElementById(id).style.display = 'flex'; 
            document.getElementById('sideMenu').classList.remove('active');
        }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function register() {
            const email = document.getElementById('reg-email').value;
            const name = document.getElementById('reg-name').value;
            const pass = document.getElementById('reg-pass').value;
            if(!email || !name || !pass) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö');
            
            currentUser = { email, name, pass }; // ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏ï‡πâ‡∏≠‡∏á Hash Password
            localStorage.setItem('user', JSON.stringify(currentUser));
            closeModal('registerModal');
            Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        }

        function logout() {
            localStorage.removeItem('user');
            currentUser = null;
            location.reload();
        }

        function openHistory() {
            if(!currentUser) return Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥', 'warning');
            const tbody = document.getElementById('history-list');
            tbody.innerHTML = history.length ? history.map(h => 
                `<tr><td>${h.game}</td><td>${h.level}</td><td>${h.score}</td><td>${h.time}s</td><td>${h.date}</td></tr>`
            ).join('') : '<tr><td colspan="5">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</td></tr>';
            openModal('historyModal');
        }

        function openDev() { openModal('devModal'); }

        // 2. Game Selection Logic
        function selectProgram(cat) {
            if(!currentUser) return Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°!', 'warning');
            
            // ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Game 1-4 (‡πÉ‡∏ä‡πâ Swal ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡πà‡∏≤‡∏¢‡πÜ)
            Swal.fire({
                title: `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${cat}`,
                input: 'select',
                inputOptions: {
                    1: 'Game 1: ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (5 ‡∏î‡πà‡∏≤‡∏ô)',
                    2: 'Game 2: ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (3 ‡∏î‡πà‡∏≤‡∏ô)',
                    3: 'Game 3: ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà (3 ‡∏î‡πà‡∏≤‡∏ô)',
                    4: 'Game 4: ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö (3 ‡∏î‡πà‡∏≤‡∏ô)'
                },
                inputPlaceholder: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡∏°',
                showCancelButton: true,
                background: '#1a1a2e', color: '#fff'
            }).then((result) => {
                if (result.isConfirmed) {
                    prepareGame(cat, parseInt(result.value));
                }
            });
        }

        // 3. Game Engine
        function prepareGame(cat, type) {
            currentGame = { category: cat, type: type, level: 1, score: 0, questionIndex: 0, timer: 0, interval: null };
            let rules = "";
            if(type === 1) rules = "‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ! (1 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏Ç‡πâ‡∏≠)";
            if(type === 2) rules = "‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (1 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏Ç‡πâ‡∏≠)";
            if(type === 3) rules = "‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ (‡πÑ‡∏°‡πà‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤)";
            if(type === 4) rules = "‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (1 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏Ç‡πâ‡∏≠)";
            
            document.getElementById('intro-title').innerText = `${cat} - Game ${type}`;
            document.getElementById('intro-desc').innerText = rules;
            openModal('introModal');
        }

        function startGameReal() {
            closeModal('introModal');
            document.getElementById('home').style.display = 'none';
            document.getElementById('game-area').style.display = 'block';
            loadLevel();
        }

        function loadLevel() {
            const { category, type, level, questionIndex } = currentGame;
            const hudLevel = document.getElementById('hud-level');
            const content = document.getElementById('game-content');
            
            hudLevel.innerText = `Level: ${level} | ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà: ${questionIndex + 1}`;
            document.getElementById('next-btn').style.display = 'none';
            
            // Logic ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏Å‡∏°
            if(type === 1) renderGame1(category, level, questionIndex);
            else if(type === 2) renderGame2(category, level, questionIndex);
            else if(type === 3) renderGame3(category, level); // ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏à‡∏ö‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ï‡πà‡∏≠‡∏î‡πà‡∏≤‡∏ô
            else if(type === 4) renderGame4(category, level, questionIndex);

            // Timer (Game 3 ‡πÑ‡∏°‡πà‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤)
            if(type !== 3) startTimer(60); 
            else document.getElementById('hud-timer').innerText = "Time: ‚àû";
        }

        function startTimer(sec) {
            clearInterval(currentGame.interval);
            let time = sec;
            document.getElementById('hud-timer').innerText = `Time: ${time}s`;
            currentGame.interval = setInterval(() => {
                time--;
                document.getElementById('hud-timer').innerText = `Time: ${time}s`;
                if(time <= 0) {
                    clearInterval(currentGame.interval);
                    Swal.fire('‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤!', '‡πÑ‡∏õ‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏∞', 'error').then(() => nextQuestion(false));
                }
            }, 1000);
        }

        // --- Renderers (‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏Å‡∏°) ---
        function renderGame1(cat, lv, idx) { // Typing
            const data = gameData[cat].game1[idx]; // ‡πÉ‡∏ä‡πâ idx ‡∏ß‡∏ô‡∏ã‡πâ‡∏≥‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏û‡∏≠
            const qData = data || gameData.Word.game1[0]; // Fallback
            
            document.getElementById('game-content').innerHTML = `
                <div style="text-align:center">
                    <p>‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ: ${qData.hint}</p>
                    <div class="word-display">${qData.q}</div>
                    <input type="text" class="answer-input" id="g1-ans" maxlength="1" onkeyup="checkGame1(this, '${qData.a}')">
                </div>
            `;
            setTimeout(()=> document.getElementById('g1-ans').focus(), 100);
        }
        function checkGame1(input, ans) {
            if(input.value.toUpperCase() === ans) {
                clearInterval(currentGame.interval);
                input.style.borderColor = "#00ff00";
                nextQuestion(true);
            }
        }

        function renderGame2(cat, lv, idx) { // Quiz
            const data = gameData[cat].game2[idx] || gameData.Word.game2[0];
            let html = `<h3>${data.q}</h3><div class="options-grid">`;
            data.opts.forEach((opt, i) => {
                html += `<div class="option-btn" onclick="checkGame2(${i}, ${data.ans})">${i+1}. ${opt}</div>`;
            });
            html += `</div>`;
            document.getElementById('game-content').innerHTML = html;
        }
        function checkGame2(selected, correct) {
            clearInterval(currentGame.interval);
            if(selected === correct) nextQuestion(true);
            else Swal.fire('‡∏ú‡∏¥‡∏î!', '', 'error').then(() => nextQuestion(false));
        }

        function renderGame3(cat, lv) { // Matching
            const data = gameData[cat].game3[lv-1] || gameData.Word.game3[0];
            // Shuffle items
            let items = [...data.pairs].sort(() => Math.random() - 0.5);
            
            let html = `<div class="matching-grid">`;
            items.forEach((item, i) => {
                html += `<div class="match-item" id="m-${i}" onclick="selectMatch(${i}, ${item.id}, this)">${item.txt}</div>`;
            });
            html += `</div>`;
            document.getElementById('game-content').innerHTML = html;
            currentGame.matchesFound = 0;
            currentGame.selectedItem = null;
        }
        function selectMatch(index, id, el) {
            if(el.classList.contains('matched')) return;
            
            if(!currentGame.selectedItem) {
                currentGame.selectedItem = { index, id, el };
                el.classList.add('selected');
            } else {
                const prev = currentGame.selectedItem;
                if(prev.index === index) return; // ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°

                if(prev.id === id) { // ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                    el.classList.add('matched');
                    prev.el.classList.add('matched');
                    currentGame.score++; // ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                    currentGame.matchesFound++;
                    updateScore();
                    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏π‡πà‡∏¢‡∏±‡∏á
                    if(currentGame.matchesFound >= 3) { // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏°‡∏µ 3 ‡∏Ñ‡∏π‡πà‡∏ï‡πà‡∏≠‡∏î‡πà‡∏≤‡∏ô
                        setTimeout(() => {
                            Swal.fire('‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!', '‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß', 'success').then(() => finishLevel());
                        }, 500);
                    }
                } else { // ‡∏ú‡∏¥‡∏î
                    el.classList.add('error');
                    setTimeout(() => {
                         el.classList.remove('error'); 
                         prev.el.classList.remove('selected');
                    }, 500);
                }
                currentGame.selectedItem = null;
            }
        }

        function renderGame4(cat, lv, idx) { // Ordering
            const data = gameData[cat].game4[idx] || gameData.Word.game4[0];
            let items = [...data.items].sort(() => Math.random() - 0.5); // ‡∏™‡∏∏‡πà‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö

            let html = `<h3>${data.q} (‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏á)</h3><ul class="order-list" id="sort-list">`;
            items.forEach(it => html += `<li class="order-item" onclick="moveItem(this)">${it}</li>`);
            html += `</ul><button class="btn-neon" onclick="checkGame4('${data.items.join(',')}')">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>`;
            document.getElementById('game-content').innerHTML = html;
        }
        // *Game 4 Logic ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢: ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ö‡∏ô‡∏™‡∏∏‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ä‡πá‡∏Ñ string*
        function checkGame4(correctStr) {
            const currentItems = Array.from(document.querySelectorAll('.order-item')).map(e => e.innerText);
            if(currentItems.join(',') === correctStr) {
                clearInterval(currentGame.interval);
                nextQuestion(true);
            } else {
                Swal.fire('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å', '‡∏•‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞', 'error');
            }
        }

        // --- Flow Control ---
        function nextQuestion(isCorrect) {
            if(isCorrect) {
                currentGame.score++;
                updateScore();
                Swal.fire({
                    title: '‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!',
                    icon: 'success',
                    timer: 1000,
                    showConfirmButton: false
                });
            }

            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Index ‡∏Ç‡πâ‡∏≠
            currentGame.questionIndex++;
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏î‡πà‡∏≤‡∏ô
            let maxQ = 5; // Default
            if(currentGame.type === 2) maxQ = 8;
            if(currentGame.type === 4) maxQ = 4;

            if(currentGame.questionIndex >= maxQ) {
                finishLevel();
            } else {
                setTimeout(loadLevel, 1000);
            }
        }

        function updateScore() {
            document.getElementById('hud-score').innerText = `Score: ${currentGame.score}`;
        }

        function finishLevel() {
            clearInterval(currentGame.interval);
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å History ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô
            const record = {
                game: `${currentGame.category} (G${currentGame.type})`,
                level: currentGame.level,
                score: currentGame.score,
                time: "Done",
                date: new Date().toLocaleDateString()
            };
            history.push(record);
            localStorage.setItem('history', JSON.stringify(history));

            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
            let maxLevel = 3;
            if(currentGame.type === 1) maxLevel = 5; // ‡πÄ‡∏Å‡∏° 1 ‡∏°‡∏µ 5 ‡∏î‡πà‡∏≤‡∏ô

            if(currentGame.level >= maxLevel) {
                Swal.fire('‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!', `‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏ö‡∏ó‡∏∏‡∏Å‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${currentGame.score}`, 'success')
                .then(() => {
                    document.getElementById('game-area').style.display = 'none';
                    document.getElementById('home').style.display = 'block';
                });
            } else {
                Swal.fire({
                    title: `‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà ${currentGame.level}`,
                    text: '‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å?',
                    showCancelButton: true,
                    confirmButtonText: '‡∏•‡∏∏‡∏¢‡∏ï‡πà‡∏≠!',
                    cancelButtonText: '‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å'
                }).then((res) => {
                    if(res.isConfirmed) {
                        currentGame.level++;
                        currentGame.questionIndex = 0;
                        loadLevel();
                    } else {
                        document.getElementById('game-area').style.display = 'none';
                        document.getElementById('home').style.display = 'block';
                    }
                });
            }
        }

    </script>
</body>
</html>