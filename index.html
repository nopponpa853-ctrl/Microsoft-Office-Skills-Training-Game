<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÄ‡∏Å‡∏°‡∏ù‡∏∂‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞ Microsoft Office</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Prompt', sans-serif;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.4); }
      50% { box-shadow: 0 0 40px rgba(99, 102, 241, 0.8); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    @keyframes confetti {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100px) rotate(720deg); opacity: 0; }
    }
    
    .float-animation {
      animation: float 3s ease-in-out infinite;
    }
    
    .pulse-glow {
      animation: pulse-glow 2s ease-in-out infinite;
    }
    
    .shake {
      animation: shake 0.5s ease-in-out;
    }
    
    .game-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .game-card:hover {
      transform: translateY(-8px) scale(1.02);
    }
    
    .menu-popup {
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }
    
    .menu-popup.active {
      transform: translateX(0);
    }
    
    .modal-overlay {
      backdrop-filter: blur(8px);
    }
    
    .dragging {
      opacity: 0.5;
      transform: scale(1.05);
    }
    
    .drag-over {
      border-color: #6366f1 !important;
      background-color: rgba(99, 102, 241, 0.1);
    }
    
    .correct-answer {
      background: linear-gradient(135deg, #10b981, #059669) !important;
      color: white !important;
    }
    
    .wrong-answer {
      background: linear-gradient(135deg, #ef4444, #dc2626) !important;
      color: white !important;
    }
    
    .matching-selected {
      border-color: #6366f1 !important;
      box-shadow: 0 0 15px rgba(99, 102, 241, 0.5);
    }
    
    .matching-matched {
      opacity: 0.5;
      pointer-events: none;
    }
    
    .gradient-word {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    }
    
    .gradient-excel {
      background: linear-gradient(135deg, #22c55e, #16a34a);
    }
    
    .gradient-powerpoint {
      background: linear-gradient(135deg, #f97316, #ea580c);
    }
    
    .tab-active {
      background: white;
      color: #6366f1;
      box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 overflow-auto">
  <div id="app" class="h-full w-full"><!-- Header -->
   <header class="bg-white/80 backdrop-blur-md shadow-lg sticky top-0 z-40">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
     <div class="flex items-center gap-3">
      <div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center float-animation"><span class="text-2xl">üéÆ</span>
      </div>
      <h1 id="site-title" class="text-xl md:text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">‡πÄ‡∏Å‡∏°‡∏ù‡∏∂‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞ Microsoft Office</h1>
     </div>
     <div class="flex items-center gap-3">
      <div id="user-info" class="hidden md:flex items-center gap-2 bg-indigo-50 px-4 py-2 rounded-full"><span class="text-indigo-600">üë§</span> <span id="user-name-display" class="text-indigo-700 font-medium"></span>
      </div><button id="menu-btn" class="p-3 hover:bg-gray-100 rounded-full transition-colors">
       <svg class="w-6 h-6 text-gray-600" fill="currentColor" viewbox="0 0 24 24"><circle cx="12" cy="5" r="2" /> <circle cx="12" cy="12" r="2" /> <circle cx="12" cy="19" r="2" />
       </svg></button>
     </div>
    </div>
   </header><!-- Menu Popup -->
   <div id="menu-overlay" class="fixed inset-0 bg-black/30 z-50 hidden"></div>
   <div id="menu-popup" class="menu-popup fixed right-0 top-0 h-full w-80 bg-white shadow-2xl z-50 overflow-y-auto">
    <div class="p-6">
     <div class="flex items-center justify-between mb-8">
      <h2 class="text-xl font-bold text-gray-800">‡πÄ‡∏°‡∏ô‡∏π</h2><button id="close-menu" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
       </svg></button>
     </div>
     <nav class="space-y-2"><button id="btn-register" class="w-full flex items-center gap-4 p-4 hover:bg-indigo-50 rounded-xl transition-colors text-left">
       <div class="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center"><span class="text-xl">üìù</span>
       </div><span class="font-medium text-gray-700">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span> </button> <button id="btn-login" class="w-full flex items-center gap-4 p-4 hover:bg-green-50 rounded-xl transition-colors text-left">
       <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"><span class="text-xl">üîë</span>
       </div><span class="font-medium text-gray-700">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</span> </button> <button id="btn-history" class="w-full flex items-center gap-4 p-4 hover:bg-purple-50 rounded-xl transition-colors text-left">
       <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center"><span class="text-xl">üìä</span>
       </div><span class="font-medium text-gray-700">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</span> </button> <button id="btn-how-to-play" class="w-full flex items-center gap-4 p-4 hover:bg-blue-50 rounded-xl transition-colors text-left">
       <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"><span class="text-xl">üìñ</span>
       </div><span class="font-medium text-gray-700">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</span> </button> <button id="btn-developer" class="w-full flex items-center gap-4 p-4 hover:bg-pink-50 rounded-xl transition-colors text-left">
       <div class="w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center"><span class="text-xl">üë©‚Äçüíª</span>
       </div><span class="font-medium text-gray-700">‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏°</span> </button> <button id="btn-logout" class="w-full flex items-center gap-4 p-4 hover:bg-red-50 rounded-xl transition-colors text-left hidden">
       <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center"><span class="text-xl">üö™</span>
       </div><span class="font-medium text-red-600">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span> </button>
      <button id="btn-admin-login" class="w-full flex items-center gap-4 p-4 hover:bg-slate-50 rounded-xl transition-colors text-left">
       <div class="w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center"><span class="text-xl">üõ°Ô∏è</span>
       </div><span class="font-medium text-gray-700">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</span>
      </button>
      <button id="btn-admin-panel" class="w-full flex items-center gap-4 p-4 hover:bg-amber-50 rounded-xl transition-colors text-left hidden">
       <div class="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center"><span class="text-xl">üß≠</span>
       </div><span class="font-medium text-amber-700">‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</span>
      </button>
    </nav>
    </div>
   </div><!-- Main Content -->
   <main class="max-w-7xl mx-auto px-4 py-8"><!-- Category Tabs -->
    <div class="flex justify-center mb-8">
     <div class="bg-white/50 backdrop-blur rounded-2xl p-2 inline-flex gap-2"><button class="category-tab tab-active px-6 py-3 rounded-xl font-medium transition-all" data-category="word"> üìò Word </button> <button class="category-tab px-6 py-3 rounded-xl font-medium transition-all text-gray-600 hover:bg-white/50" data-category="excel"> üìó Excel </button> <button class="category-tab px-6 py-3 rounded-xl font-medium transition-all text-gray-600 hover:bg-white/50" data-category="powerpoint"> üìô PowerPoint </button>
     </div>
    </div><!-- Games Grid -->
    <div id="games-container" class="grid grid-cols-1 md:grid-cols-2 gap-6"><!-- Game cards will be rendered here -->
    </div>
   </main><!-- Footer -->
   <footer class="bg-white/80 backdrop-blur-md mt-12 py-8">
    <div class="max-w-7xl mx-auto px-4 text-center">
     <div class="flex items-center justify-center gap-2 mb-4"><span class="text-2xl">üè´</span>
      <p id="footer-text" class="text-gray-600 font-medium">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à &amp; ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</p>
     </div>
     <p class="text-sm text-gray-400">¬© 2024 Microsoft Office Skills Training Game</p>
    </div>
   </footer>
  </div><!-- Modals Container -->
  <div id="modals-container"></div>
  <script>
    // ==================== Game Data ====================
    const gameData = {
      word: {
        name: 'Microsoft Word',
        icon: 'üìò',
        gradient: 'gradient-word',
        typing: [
          { word: 'DOCUMENT', hint: 'D_C_M_NT', answer: 'DOCUMENT', desc: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£' },
          { word: 'PARAGRAPH', hint: 'P_R_GR_PH', answer: 'PARAGRAPH', desc: '‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤' },
          { word: 'FONT', hint: 'F_NT', answer: 'FONT', desc: '‡πÅ‡∏ö‡∏ö‡∏≠‡∏±‡∏Å‡∏©‡∏£' },
          { word: 'MARGIN', hint: 'M_RG_N', answer: 'MARGIN', desc: '‡∏£‡∏∞‡∏¢‡∏∞‡∏Ç‡∏≠‡∏ö' },
          { word: 'HEADER', hint: 'H_ _D_R', answer: 'HEADER', desc: '‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©' },
          { word: 'FOOTER', hint: 'F_ _T_R', answer: 'FOOTER', desc: '‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©' },
          { word: 'TABLE', hint: 'T_BL_', answer: 'TABLE', desc: '‡∏ï‡∏≤‡∏£‡∏≤‡∏á' },
          { word: 'BULLET', hint: 'B_LL_T', answer: 'BULLET', desc: '‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°' },
          { word: 'INDENT', hint: '_ND_NT', answer: 'INDENT', desc: '‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏∑‡πâ‡∏≠‡∏á' },
          { word: 'SPELLING', hint: 'SP_LL_NG', answer: 'SPELLING', desc: '‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥' }
        ],
        quiz: [
          { q: '‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á Microsoft Word ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['.docx', '.xlsx', '.pptx', '.pdf'], answer: 0 },
          { q: '‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î Ctrl+B ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏Ç‡∏µ‡∏î‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ', '‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤', '‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏µ‡∏¢‡∏á', '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å'], answer: 1 },
          { q: '‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©?', choices: ['Home', 'Insert', 'Layout', 'View'], answer: 2 },
          { q: 'Ctrl+S ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö?', choices: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤', '‡∏û‡∏¥‡∏°‡∏û‡πå'], answer: 1 },
          { q: '‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Mail Merge ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö?', choices: ['‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå', '‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô', '‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•', '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏£‡∏≤‡∏á'], answer: 1 },
          { q: 'Tab ‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏£‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û?', choices: ['Home', 'Insert', 'Design', 'References'], answer: 1 },
          { q: 'Ctrl+Z ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏ó‡∏≥‡∏ã‡πâ‡∏≥', '‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö', '‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå', '‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà'], answer: 1 },
          { q: 'Word Art ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û', '‡∏ï‡∏≤‡∏£‡∏≤‡∏á', '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏®‡∏¥‡∏•‡∏õ‡πå', '‡∏Å‡∏£‡∏≤‡∏ü'], answer: 2 },
          { q: 'Page Break ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö?', choices: ['‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤', '‡πÅ‡∏ö‡πà‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå', '‡πÅ‡∏ö‡πà‡∏á‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤', '‡πÅ‡∏ö‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô'], answer: 0 },
          { q: 'Track Changes ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á', '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ', '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ü‡∏≠‡∏ô‡∏ï‡πå', '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î'], answer: 0 }
        ],
        matching: [
          { left: 'üìÑ', right: 'Document', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£' },
          { left: 'üî§', right: 'Font', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ü‡∏≠‡∏ô‡∏ï‡πå' },
          { left: 'üìã', right: 'Clipboard', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î' },
          { left: 'üñ®Ô∏è', right: 'Print', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå' },
          { left: 'üíæ', right: 'Save', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å' },
          { left: 'üìù', right: 'Edit', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç' }
        ],
        scenario: [
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà', steps: ['‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Word', '‡∏Ñ‡∏•‡∏¥‡∏Å File', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å New', '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å File', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Save As', '‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå', '‡∏Ñ‡∏•‡∏¥‡∏Å Save'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°', '‡∏Ñ‡∏•‡∏¥‡∏Å Home', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Font', '‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏£‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Insert', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Pictures', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ', '‡∏Ñ‡∏•‡∏¥‡∏Å Insert'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Insert', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Table', '‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î', '‡∏Ñ‡∏•‡∏¥‡∏Å OK'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Layout', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Size', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Margins', '‡∏Ñ‡∏•‡∏¥‡∏Å OK'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å File', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Print', '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå', '‡∏Ñ‡∏•‡∏¥‡∏Å Print'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Review', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Spelling', '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≥'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Header/Footer', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Insert', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Header', '‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°', '‡∏Ñ‡∏•‡∏¥‡∏Å Close'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å File', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Export', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å PDF', '‡∏Ñ‡∏•‡∏¥‡∏Å Publish'] }
        ]
      },
      excel: {
        name: 'Microsoft Excel',
        icon: 'üìó',
        gradient: 'gradient-excel',
        typing: [
          { word: 'CELL', hint: 'C_LL', answer: 'CELL', desc: '‡πÄ‡∏ã‡∏•‡∏•‡πå' },
          { word: 'FORMULA', hint: 'F_RM_LA', answer: 'FORMULA', desc: '‡∏™‡∏π‡∏ï‡∏£' },
          { word: 'WORKSHEET', hint: 'W_RKS_ _ET', answer: 'WORKSHEET', desc: '‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô' },
          { word: 'CHART', hint: 'CH_RT', answer: 'CHART', desc: '‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥' },
          { word: 'FILTER', hint: 'F_LT_R', answer: 'FILTER', desc: '‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á' },
          { word: 'PIVOT', hint: 'P_V_T', answer: 'PIVOT', desc: '‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ' },
          { word: 'COLUMN', hint: 'C_L_MN', answer: 'COLUMN', desc: '‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå' },
          { word: 'ROW', hint: 'R_W', answer: 'ROW', desc: '‡πÅ‡∏ñ‡∏ß' },
          { word: 'FUNCTION', hint: 'F_NCT_ _N', answer: 'FUNCTION', desc: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô' },
          { word: 'RANGE', hint: 'R_NG_', answer: 'RANGE', desc: '‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' }
        ],
        quiz: [
          { q: '‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á Excel ‡∏Ñ‡∏∑‡∏≠?', choices: ['.docx', '.xlsx', '.pptx', '.txt'], answer: 1 },
          { q: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô SUM ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô', '‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢', '‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤', '‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î'], answer: 2 },
          { q: '‡πÄ‡∏ã‡∏•‡∏•‡πå A1 ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á?', choices: ['‡πÅ‡∏ñ‡∏ß A ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 1', '‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A ‡πÅ‡∏ñ‡∏ß 1', '‡∏´‡∏ô‡πâ‡∏≤ A ‡∏Ç‡πâ‡∏≠ 1', '‡πÑ‡∏ü‡∏•‡πå A ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ 1'], answer: 1 },
          { q: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô AVERAGE ‡πÉ‡∏ä‡πâ‡∏´‡∏≤?', choices: ['‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î', '‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î', '‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'], answer: 2 },
          { q: 'Freeze Panes ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏•‡πá‡∏≠‡∏Ñ‡πÅ‡∏ñ‡∏ß/‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå', '‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'], answer: 0 },
          { q: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô COUNT ‡∏ô‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£', '‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç', '‡∏™‡∏π‡∏ï‡∏£', '‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô'], answer: 1 },
          { q: 'Conditional Formatting ‡∏Ñ‡∏∑‡∏≠?', choices: ['‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç', '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á', '‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á', '‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡πÄ‡∏ã‡∏•‡∏•‡πå'], answer: 0 },
          { q: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô MAX ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î', '‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î', '‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢', '‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°'], answer: 1 },
          { q: 'VLOOKUP ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö?', choices: ['‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á', '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô', '‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á', '‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'], answer: 0 },
          { q: 'Workbook ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô', '‡∏™‡∏°‡∏∏‡∏î‡∏á‡∏≤‡∏ô/‡πÑ‡∏ü‡∏•‡πå', '‡πÄ‡∏ã‡∏•‡∏•‡πå', '‡πÅ‡∏ñ‡∏ß'], answer: 1 }
        ],
        matching: [
          { left: 'üìä', right: 'Chart', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥' },
          { left: 'üî¢', right: 'Number', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç' },
          { left: 'üìà', right: 'Graph', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏≤‡∏ü' },
          { left: 'üßÆ', right: 'Calculate', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì' },
          { left: 'üìâ', right: 'Trend', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°' },
          { left: 'üóÉÔ∏è', right: 'Data', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' }
        ],
        scenario: [
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏π‡∏ï‡∏£‡∏ö‡∏ß‡∏Å', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå', '‡∏û‡∏¥‡∏°‡∏û‡πå =', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå‡πÅ‡∏£‡∏Å', '‡∏Å‡∏î Enter'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô SUM', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå', '‡∏û‡∏¥‡∏°‡∏û‡πå =SUM(', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏õ‡∏¥‡∏î‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡πÅ‡∏•‡∏∞ Enter'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏Ñ‡∏•‡∏¥‡∏Å Insert', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Chart', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏£‡∏≤‡∏ü'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ AutoFill', steps: ['‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå', '‡∏•‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤', '‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÄ‡∏°‡∏≤‡∏™‡πå'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á', '‡∏Ñ‡∏•‡∏¥‡∏Å Data', '‡∏Ñ‡∏•‡∏¥‡∏Å Filter', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏Ñ‡∏•‡∏¥‡∏Å Data', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Sort', '‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ VLOOKUP', steps: ['‡∏û‡∏¥‡∏°‡∏û‡πå =VLOOKUP(', '‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤', '‡πÉ‡∏™‡πà‡∏ä‡πà‡∏ß‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á', '‡∏õ‡∏¥‡∏î‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö'] },
          { title: '‡∏Å‡∏≤‡∏£ Freeze Panes', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå', '‡∏Ñ‡∏•‡∏¥‡∏Å View', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Freeze Panes', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏Ñ‡∏•‡∏¥‡∏Å Home', '‡∏Ñ‡∏•‡∏¥‡∏Å Conditional Formatting', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏é'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Pivot Table', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏Ñ‡∏•‡∏¥‡∏Å Insert', '‡∏Ñ‡∏•‡∏¥‡∏Å PivotTable', '‡∏Ñ‡∏•‡∏¥‡∏Å OK'] }
        ]
      },
      powerpoint: {
        name: 'Microsoft PowerPoint',
        icon: 'üìô',
        gradient: 'gradient-powerpoint',
        typing: [
          { word: 'SLIDE', hint: 'SL_D_', answer: 'SLIDE', desc: '‡∏™‡πÑ‡∏•‡∏î‡πå' },
          { word: 'ANIMATION', hint: 'AN_M_T_ _N', answer: 'ANIMATION', desc: '‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß' },
          { word: 'TRANSITION', hint: 'TR_NS_T_ _N', answer: 'TRANSITION', desc: '‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡πÑ‡∏•‡∏î‡πå' },
          { word: 'TEMPLATE', hint: 'T_MPL_T_', answer: 'TEMPLATE', desc: '‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö' },
          { word: 'LAYOUT', hint: 'L_Y_ _T', answer: 'LAYOUT', desc: '‡πÄ‡∏Ñ‡πâ‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á' },
          { word: 'PRESENTER', hint: 'PR_S_NT_R', answer: 'PRESENTER', desc: '‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠' },
          { word: 'DESIGN', hint: 'D_S_GN', answer: 'DESIGN', desc: '‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö' },
          { word: 'MASTER', hint: 'M_ST_R', answer: 'MASTER', desc: '‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö' },
          { word: 'SLIDESHOW', hint: 'SL_D_SH_W', answer: 'SLIDESHOW', desc: '‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠' },
          { word: 'THEME', hint: 'TH_M_', answer: 'THEME', desc: '‡∏ò‡∏µ‡∏°' }
        ],
        quiz: [
          { q: '‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå PowerPoint ‡∏Ñ‡∏∑‡∏≠?', choices: ['.docx', '.xlsx', '.pptx', '.pdf'], answer: 2 },
          { q: 'F5 ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö?', choices: ['‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠', '‡∏û‡∏¥‡∏°‡∏û‡πå', '‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå'], answer: 1 },
          { q: 'Transition ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏', '‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡πÑ‡∏•‡∏î‡πå', '‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ', '‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ü‡∏≠‡∏ô‡∏ï‡πå'], answer: 1 },
          { q: 'Animation ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏™‡πÑ‡∏•‡∏î‡πå', '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡πÉ‡∏ô‡∏™‡πÑ‡∏•‡∏î‡πå', '‡πÑ‡∏ü‡∏•‡πå', '‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°'], answer: 1 },
          { q: 'Slide Master ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏™‡πÑ‡∏•‡∏î‡πå‡πÅ‡∏£‡∏Å', '‡∏™‡πÑ‡∏•‡∏î‡πå‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢', '‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡πÑ‡∏•‡∏î‡πå', '‡∏™‡πÑ‡∏•‡∏î‡πå‡∏ß‡πà‡∏≤‡∏á'], answer: 2 },
          { q: 'Tab ‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡πÉ‡∏™‡πà Animation?', choices: ['Home', 'Insert', 'Animations', 'Design'], answer: 2 },
          { q: 'Presenter View ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡πÇ‡∏ô‡πâ‡∏ï‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢', '‡∏™‡πÑ‡∏•‡∏î‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', '‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', '‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏∞‡πÑ‡∏£'], answer: 0 },
          { q: 'Smart Art ‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏ï‡∏≤‡∏£‡∏≤‡∏á', '‡∏ú‡∏±‡∏á‡∏†‡∏≤‡∏û', '‡∏Å‡∏£‡∏≤‡∏ü', '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°'], answer: 1 },
          { q: 'Esc ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏ì‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠?', choices: ['‡∏Ç‡πâ‡∏≤‡∏°‡∏™‡πÑ‡∏•‡∏î‡πå', '‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠', '‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö', '‡∏ã‡∏π‡∏°‡πÄ‡∏Ç‡πâ‡∏≤'], answer: 1 },
          { q: 'Notes ‡πÉ‡∏ô PowerPoint ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?', choices: ['‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏/‡πÇ‡∏ô‡πâ‡∏ï', '‡πÄ‡∏™‡∏µ‡∏¢‡∏á', '‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠', '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û'], answer: 0 }
        ],
        matching: [
          { left: 'üé¨', right: 'Animation', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô' },
          { left: 'üñºÔ∏è', right: 'Slide', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡πÑ‡∏•‡∏î‡πå' },
          { left: 'üé®', right: 'Design', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö' },
          { left: '‚ñ∂Ô∏è', right: 'Play', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô' },
          { left: 'üîÑ', right: 'Transition', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡πÑ‡∏•‡∏î‡πå' },
          { left: 'üé§', right: 'Presentation', leftLabel: '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠' }
        ],
        scenario: [
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡πÉ‡∏´‡∏°‡πà', steps: ['‡πÄ‡∏õ‡∏¥‡∏î PowerPoint', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Template', '‡πÉ‡∏™‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠', '‡∏Ñ‡∏•‡∏¥‡∏Å Create'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏•‡∏î‡πå‡πÉ‡∏´‡∏°‡πà', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Home', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å New Slide', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Layout', '‡πÉ‡∏™‡πà‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Insert', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Pictures', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå', '‡∏Ñ‡∏•‡∏¥‡∏Å Insert'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà Animation', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏', '‡∏Ñ‡∏•‡∏¥‡∏Å Animations', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå', '‡∏õ‡∏£‡∏±‡∏ö Timing'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà Transition', steps: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡πÑ‡∏•‡∏î‡πå', '‡∏Ñ‡∏•‡∏¥‡∏Å Transitions', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå', '‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà Smart Art', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Insert', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å SmartArt', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó', '‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°'] },
          { title: '‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Slide Master', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å View', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Slide Master', '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö', '‡∏Ñ‡∏•‡∏¥‡∏Å Close'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å File', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Save As', '‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå', '‡∏Ñ‡∏•‡∏¥‡∏Å Save'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Slideshow', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å Slide Show', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å From Beginning', '‡∏î‡∏π‡∏á‡∏≤‡∏ô‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠', '‡∏Å‡∏î Esc'] },
          { title: '‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠', steps: ['‡∏Ñ‡∏•‡∏¥‡∏Å File', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Export', '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Video', '‡∏Ñ‡∏•‡∏¥‡∏Å Create'] }
        ]
      }
    };

    // ==================== State Management ====================
    let currentUser = null;
    let currentAdmin = null;
    let allData = [];
    let currentCategory = 'word';
    let currentGame = null;
    let gameState = {};

    // ==================== Default Config ====================
    const defaultConfig = {
      site_title: '‡πÄ‡∏Å‡∏°‡∏ù‡∏∂‡∏Å‡∏ó‡∏±‡∏Å‡∏©‡∏∞ Microsoft Office',
      footer_text: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à & ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•',
      primary_color: '#6366f1',
      secondary_color: '#8b5cf6',
      background_color: '#f5f3ff',
      text_color: '#1e1b4b',
      accent_color: '#ec4899'
    };

    let config = { ...defaultConfig };

    const adminCredential = {
      email: 'nopponpa853@gmail.com',
      password: 'love_0965840062',
      name: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö'
    };

    // ==================== Data SDK Handler ====================
    const dataHandler = {
      onDataChanged(data) {
        allData = data;
        checkLoginStatus();
      }
    };

    function checkLoginStatus() {
      const savedEmail = localStorage.getItem('currentUserEmail');
      if (savedEmail) {
        const user = allData.find(d => d.user_type === 'user' && d.email === savedEmail);
        if (user) {
          currentUser = user;
          updateUIForLoggedIn();
        } else {
          updateUIForLoggedOut();
        }
      } else {
        updateUIForLoggedOut();
      }

      const savedAdminEmail = localStorage.getItem('currentAdminEmail');
      if (savedAdminEmail) {
        const admin = findAdminByEmail(savedAdminEmail);
        if (admin) {
          currentAdmin = admin;
          updateUIForAdmin();
        } else {
          updateUIForAdminLoggedOut();
        }
      } else {
        updateUIForAdminLoggedOut();
      }
    }

    function findAdminByEmail(email) {
      if (email === adminCredential.email) {
        return { ...adminCredential, user_type: 'admin' };
      }
      return allData.find(d => d.user_type === 'admin' && d.email === email) || null;
    }

    function updateUIForLoggedIn() {
      if (currentUser) {
        document.getElementById('user-info').classList.remove('hidden');
        document.getElementById('user-name-display').textContent = currentUser.name;
        document.getElementById('btn-register').classList.add('hidden');
        document.getElementById('btn-login').classList.add('hidden');
        document.getElementById('btn-logout').classList.remove('hidden');
      }
    }

    function updateUIForLoggedOut() {
      document.getElementById('user-info').classList.add('hidden');
      document.getElementById('btn-register').classList.remove('hidden');
      document.getElementById('btn-login').classList.remove('hidden');
      document.getElementById('btn-logout').classList.add('hidden');
      currentUser = null;
    }

    function updateUIForAdmin() {
      if (currentAdmin) {
        document.getElementById('btn-admin-login').classList.add('hidden');
        document.getElementById('btn-admin-panel').classList.remove('hidden');
      }
    }

    function updateUIForAdminLoggedOut() {
      document.getElementById('btn-admin-login').classList.remove('hidden');
      document.getElementById('btn-admin-panel').classList.add('hidden');
      currentAdmin = null;
    }

    // ==================== Element SDK ====================
    async function initElementSdk() {
      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (newConfig) => {
            config = { ...config, ...newConfig };
            applyConfig();
          },
          mapToCapabilities: (cfg) => ({
            recolorables: [
              {
                get: () => cfg.primary_color || defaultConfig.primary_color,
                set: (v) => { cfg.primary_color = v; window.elementSdk.setConfig({ primary_color: v }); }
              },
              {
                get: () => cfg.secondary_color || defaultConfig.secondary_color,
                set: (v) => { cfg.secondary_color = v; window.elementSdk.setConfig({ secondary_color: v }); }
              },
              {
                get: () => cfg.background_color || defaultConfig.background_color,
                set: (v) => { cfg.background_color = v; window.elementSdk.setConfig({ background_color: v }); }
              },
              {
                get: () => cfg.text_color || defaultConfig.text_color,
                set: (v) => { cfg.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
              },
              {
                get: () => cfg.accent_color || defaultConfig.accent_color,
                set: (v) => { cfg.accent_color = v; window.elementSdk.setConfig({ accent_color: v }); }
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (cfg) => new Map([
            ['site_title', cfg.site_title || defaultConfig.site_title],
            ['footer_text', cfg.footer_text || defaultConfig.footer_text]
          ])
        });
        config = { ...defaultConfig, ...window.elementSdk.config };
      }
      applyConfig();
    }

    function applyConfig() {
      document.getElementById('site-title').textContent = config.site_title || defaultConfig.site_title;
      document.getElementById('footer-text').textContent = config.footer_text || defaultConfig.footer_text;
    }

    // ==================== Modal Functions ====================
    function showModal(content, id = 'modal') {
      const container = document.getElementById('modals-container');
      container.innerHTML = `
        <div id="${id}" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay bg-black/50">
          <div class="bg-white rounded-3xl shadow-2xl max-w-lg w-full max-h-[90%] overflow-y-auto animate-in">
            ${content}
          </div>
        </div>
      `;
      
      document.getElementById(id).addEventListener('click', (e) => {
        if (e.target.id === id) closeModal();
      });
    }

    function showGameModal(content, id = 'game-modal') {
      const container = document.getElementById('modals-container');
      container.innerHTML = `
        <div id="${id}" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay bg-black/50">
          <div class="bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[90%] overflow-y-auto">
            ${content}
          </div>
        </div>
      `;
    }

    function closeModal() {
      document.getElementById('modals-container').innerHTML = '';
    }

    // ==================== How to Play Modal ====================
    function showHowToPlay() {
      const content = `
        <div class="p-8">
          <div class="text-center mb-8">
            <span class="text-6xl mb-4 block">üéÆ</span>
            <h2 class="text-2xl font-bold text-gray-800">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</h2>
            <p class="text-gray-500 mt-2">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á 4 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</p>
          </div>
          
          <div class="space-y-6">
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-5 rounded-2xl">
              <div class="flex items-center gap-3 mb-3">
                <span class="text-2xl">‚å®Ô∏è</span>
                <h3 class="font-bold text-blue-700">‡πÄ‡∏Å‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</h3>
              </div>
              <p class="text-gray-600 text-sm">‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (10 ‡∏Ç‡πâ‡∏≠)</p>
            </div>
            
            <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-5 rounded-2xl">
              <div class="flex items-center gap-3 mb-3">
                <span class="text-2xl">‚ùì</span>
                <h3 class="font-bold text-green-700">‡πÄ‡∏Å‡∏°‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</h3>
              </div>
              <p class="text-gray-600 text-sm">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å 4 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (10 ‡∏Ç‡πâ‡∏≠)</p>
            </div>
            
            <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-5 rounded-2xl">
              <div class="flex items-center gap-3 mb-3">
                <span class="text-2xl">üîó</span>
                <h3 class="font-bold text-purple-700">‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà</h3>
              </div>
              <p class="text-gray-600 text-sm">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (6 ‡∏Ñ‡∏π‡πà)</p>
              <p class="text-purple-600 text-xs mt-2">üí° ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà</p>
            </div>
            
            <div class="bg-gradient-to-r from-orange-50 to-amber-50 p-5 rounded-2xl">
              <div class="flex items-center gap-3 mb-3">
                <span class="text-2xl">üìã</span>
                <h3 class="font-bold text-orange-700">‡πÄ‡∏Å‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå</h3>
              </div>
              <p class="text-gray-600 text-sm">‡∏•‡∏≤‡∏Å‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (10 ‡∏Ç‡πâ‡∏≠ ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏µ 4 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô)</p>
            </div>
          </div>
          
          <div class="mt-8 p-4 bg-yellow-50 rounded-xl">
            <p class="text-center text-yellow-700 font-medium">
              üí° <strong>‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:</strong> ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å 1 ‡∏Ç‡πâ‡∏≠ = 1 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
            </p>
            <p class="text-center text-yellow-700 font-medium mt-2">
              ‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°
            </p>
          </div>
          
          <button onclick="closeModal()" class="w-full mt-6 py-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold rounded-xl hover:opacity-90 transition-opacity">
            ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏¢! üöÄ
          </button>
        </div>
      `;
      showModal(content, 'how-to-play-modal');
    }

    // ==================== Auth Modals ====================
    function showRegisterModal() {
      const content = `
        <div class="p-8">
          <div class="text-center mb-6">
            <span class="text-5xl mb-3 block">üìù</span>
            <h2 class="text-2xl font-bold text-gray-800">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
          </div>
          
          <form id="register-form" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
              <input type="email" id="reg-email" required
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors"
                placeholder="example@email.com">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠</label>
              <input type="text" id="reg-name" required
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors"
                placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
              <input type="password" id="reg-password" required minlength="4"
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            
            <div id="reg-error" class="hidden text-red-500 text-sm text-center p-3 bg-red-50 rounded-xl"></div>
            <div id="reg-success" class="hidden text-green-500 text-sm text-center p-3 bg-green-50 rounded-xl"></div>
            
            <button type="submit" id="reg-btn" class="w-full py-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold rounded-xl hover:opacity-90 transition-opacity">
              ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
            </button>
          </form>
          
          <button onclick="closeModal()" class="w-full mt-3 py-3 text-gray-500 hover:text-gray-700 transition-colors">
            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </button>
        </div>
      `;
      showModal(content, 'register-modal');
      closeMenu();
      
      document.getElementById('register-form').addEventListener('submit', handleRegister);
    }

    async function handleRegister(e) {
      e.preventDefault();
      const email = document.getElementById('reg-email').value.trim();
      const name = document.getElementById('reg-name').value.trim();
      const password = document.getElementById('reg-password').value;
      const errorDiv = document.getElementById('reg-error');
      const successDiv = document.getElementById('reg-success');
      const btn = document.getElementById('reg-btn');
      
      errorDiv.classList.add('hidden');
      successDiv.classList.add('hidden');
      
      // Check if email exists
      const existingUser = allData.find(d => d.user_type === 'user' && d.email === email);
      if (existingUser) {
        errorDiv.textContent = '‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß';
        errorDiv.classList.remove('hidden');
        return;
      }
      
      // Check record limit
      if (allData.length >= 999) {
        errorDiv.textContent = '‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•';
        errorDiv.classList.remove('hidden');
        return;
      }
      
      btn.disabled = true;
      btn.innerHTML = '<span class="animate-spin">‚è≥</span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏°‡∏±‡∏Ñ‡∏£...';
      
      const result = await window.dataSdk.create({
        user_type: 'user',
        email: email,
        name: name,
        password: password,
        game_name: '',
        level: '',
        score: 0,
        played_at: ''
      });
      
      if (result.isOk) {
        successDiv.textContent = '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö';
        successDiv.classList.remove('hidden');
        setTimeout(() => {
          closeModal();
          showLoginModal();
        }, 1500);
      } else {
        errorDiv.textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà';
        errorDiv.classList.remove('hidden');
      }
      
      btn.disabled = false;
      btn.textContent = '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å';
    }

    function showLoginModal() {
      const content = `
        <div class="p-8">
          <div class="text-center mb-6">
            <span class="text-5xl mb-3 block">üîë</span>
            <h2 class="text-2xl font-bold text-gray-800">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
          </div>
          
          <form id="login-form" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
              <input type="email" id="login-email" required
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors"
                placeholder="example@email.com">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
              <input type="password" id="login-password" required
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            
            <div id="login-error" class="hidden text-red-500 text-sm text-center p-3 bg-red-50 rounded-xl"></div>
            
            <button type="submit" class="w-full py-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl hover:opacity-90 transition-opacity">
              ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
            </button>
          </form>
          
          <button onclick="closeModal()" class="w-full mt-3 py-3 text-gray-500 hover:text-gray-700 transition-colors">
            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </button>
        </div>
      `;
      showModal(content, 'login-modal');
      closeMenu();
      
      document.getElementById('login-form').addEventListener('submit', handleLogin);
    }

    function handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const errorDiv = document.getElementById('login-error');
      
      const user = allData.find(d => d.user_type === 'user' && d.email === email && d.password === password);
      
      if (user) {
        currentUser = user;
        localStorage.setItem('currentUserEmail', email);
        updateUIForLoggedIn();
        closeModal();
        showToast('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ', 'success');
      } else {
        errorDiv.textContent = '‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
        errorDiv.classList.remove('hidden');
      }
    }

    function handleLogout() {
      localStorage.removeItem('currentUserEmail');
      updateUIForLoggedOut();
      closeMenu();
      showToast('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'info');
    }

    function handleAdminLogout() {
      localStorage.removeItem('currentAdminEmail');
      updateUIForAdminLoggedOut();
      closeMenu();
      showToast('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'info');
    }

    // ==================== History Modal ====================
    function showHistoryModal() {
      closeMenu();
      
      if (!currentUser) {
        showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô', 'warning');
        return;
      }
      
      const userHistory = allData.filter(d => d.user_type === 'history' && d.email === currentUser.email);
      
      let historyHTML = '';
      if (userHistory.length === 0) {
        historyHTML = `
          <div class="text-center py-12">
            <span class="text-6xl block mb-4">üì≠</span>
            <p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</p>
          </div>
        `;
      } else {
        historyHTML = `
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="bg-indigo-50">
                  <th class="px-4 py-3 text-left text-sm font-bold text-indigo-700 rounded-tl-xl">‡πÄ‡∏Å‡∏°</th>
                  <th class="px-4 py-3 text-left text-sm font-bold text-indigo-700">‡∏´‡∏°‡∏ß‡∏î</th>
                  <th class="px-4 py-3 text-center text-sm font-bold text-indigo-700">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                  <th class="px-4 py-3 text-right text-sm font-bold text-indigo-700 rounded-tr-xl">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-100">
                ${userHistory.map(h => `
                  <tr class="hover:bg-gray-50 transition-colors">
                    <td class="px-4 py-3 text-sm text-gray-700">${h.game_name}</td>
                    <td class="px-4 py-3 text-sm text-gray-500">${h.level}</td>
                    <td class="px-4 py-3 text-center">
                      <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold ${h.score >= 7 ? 'bg-green-100 text-green-700' : h.score >= 4 ? 'bg-yellow-100 text-yellow-700' : 'bg-red-100 text-red-700'}">
                        ${h.score}
                      </span>
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-400 text-right">${h.played_at}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
        `;
      }
      
      const content = `
        <div class="p-8">
          <div class="text-center mb-6">
            <span class="text-5xl mb-3 block">üìä</span>
            <h2 class="text-2xl font-bold text-gray-800">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h2>
            <p class="text-gray-500">${currentUser.name}</p>
          </div>
          ${historyHTML}
          <button onclick="closeModal()" class="w-full mt-6 py-3 bg-gray-100 text-gray-700 font-medium rounded-xl hover:bg-gray-200 transition-colors">
            ‡∏õ‡∏¥‡∏î
          </button>
        </div>
      `;
      showModal(content, 'history-modal');
    }

    // ==================== Developer Modal ====================
    function showDeveloperModal() {
      closeMenu();
      
      const content = `
        <div class="p-8">
          <div class="text-center mb-8">
            <span class="text-6xl mb-4 block">üë©‚Äçüíª</span>
            <h2 class="text-2xl font-bold text-gray-800">‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏°</h2>
          </div>
          
          <div class="bg-gradient-to-br from-pink-50 to-purple-50 p-6 rounded-2xl">
            <div class="space-y-4">
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-pink-100 rounded-xl flex items-center justify-center">
                  <span class="text-2xl">üë§</span>
                </div>
                <div>
                  <p class="text-sm text-gray-500">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</p>
                  <p class="font-bold text-gray-800">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏õ‡∏≤‡∏ô‡∏£‡∏∞‡∏ß‡∏±‡∏ô ‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå</p>
                </div>
              </div>
              
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center">
                  <span class="text-2xl">üéì</span>
                </div>
                <div>
                  <p class="text-sm text-gray-500">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</p>
                  <p class="font-bold text-gray-800">‡∏ä‡∏Ñ‡∏û.3/1</p>
                </div>
              </div>
              
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center">
                  <span class="text-2xl">üìû</span>
                </div>
                <div>
                  <p class="text-sm text-gray-500">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</p>
                  <p class="font-bold text-gray-800">096-584-0062</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="mt-6 p-4 bg-gray-50 rounded-xl text-center text-gray-400 text-sm">
            ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï
          </div>
          
          <button onclick="closeModal()" class="w-full mt-6 py-3 bg-gray-100 text-gray-700 font-medium rounded-xl hover:bg-gray-200 transition-colors">
            ‡∏õ‡∏¥‡∏î
          </button>
        </div>
      `;
      showModal(content, 'developer-modal');
    }

    // ==================== Admin Modals ====================
    function showAdminLoginModal() {
      const content = `
        <div class="p-8">
          <div class="text-center mb-6">
            <span class="text-5xl mb-3 block">üõ°Ô∏è</span>
            <h2 class="text-2xl font-bold text-gray-800">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h2>
            <p class="text-sm text-gray-500 mt-2">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
          </div>

          <form id="admin-login-form" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</label>
              <input type="email" id="admin-login-email" required
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors"
                placeholder="admin@email.com">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
              <input type="password" id="admin-login-password" required
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>

            <div id="admin-login-error" class="hidden text-red-500 text-sm text-center p-3 bg-red-50 rounded-xl"></div>
            
            <button type="submit" class="w-full py-4 bg-gradient-to-r from-slate-700 to-slate-900 text-white font-bold rounded-xl hover:opacity-90 transition-opacity">
              ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
            </button>
          </form>
          
          <button onclick="closeModal()" class="w-full mt-3 py-3 text-gray-500 hover:text-gray-700 transition-colors">
            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </button>
        </div>
      `;
      showModal(content, 'admin-login-modal');
      closeMenu();

      document.getElementById('admin-login-form').addEventListener('submit', handleAdminLogin);
    }

    function handleAdminLogin(e) {
      e.preventDefault();
      const email = document.getElementById('admin-login-email').value.trim();
      const password = document.getElementById('admin-login-password').value;
      const errorDiv = document.getElementById('admin-login-error');
      const admin =
        (email === adminCredential.email && password === adminCredential.password)
          ? { ...adminCredential, user_type: 'admin' }
          : allData.find(d => d.user_type === 'admin' && d.email === email && d.password === password);

      if (admin) {
        currentAdmin = admin;
        localStorage.setItem('currentAdminEmail', email);
        updateUIForAdmin();
        closeModal();
        showToast('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ', 'success');
      } else {
        errorDiv.textContent = '‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
        errorDiv.classList.remove('hidden');
      }
    }

    function showAdminPanel() {
      closeMenu();

      if (!currentAdmin) {
        showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô', 'warning');
        showAdminLoginModal();
        return;
      }

      const users = allData.filter(d => d.user_type === 'user');
      const history = allData.filter(d => d.user_type === 'history');
      const lastPlays = history
        .slice()
        .sort((a, b) => new Date(b.played_at) - new Date(a.played_at))
        .slice(0, 5);

      const content = `
        <div class="p-8">
          <div class="flex items-center justify-between mb-6">
            <div>
              <h2 class="text-2xl font-bold text-gray-800">‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h2>
              <p class="text-sm text-gray-500">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•: ${currentAdmin.name}</p>
            </div>
            <button onclick="handleAdminLogout()" class="px-4 py-2 text-sm bg-red-50 text-red-600 rounded-xl hover:bg-red-100 transition-colors">
              ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div class="p-5 rounded-2xl bg-gradient-to-br from-indigo-50 to-indigo-100">
              <p class="text-sm text-indigo-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</p>
              <p class="text-3xl font-bold text-indigo-800">${users.length}</p>
            </div>
            <div class="p-5 rounded-2xl bg-gradient-to-br from-emerald-50 to-emerald-100">
              <p class="text-sm text-emerald-600">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
              <p class="text-3xl font-bold text-emerald-800">${history.length}</p>
            </div>
            <div class="p-5 rounded-2xl bg-gradient-to-br from-amber-50 to-amber-100">
              <p class="text-sm text-amber-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö</p>
              <p class="text-xl font-bold text-amber-800">${allData.length}/999 ‡πÄ‡∏£‡∏Ñ‡∏Ñ‡∏≠‡∏£‡πå‡∏î</p>
            </div>
          </div>

          <div class="mb-6">
            <h3 class="text-lg font-bold text-gray-800 mb-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</h3>
            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <thead>
                  <tr class="bg-slate-100 text-slate-700">
                    <th class="px-4 py-2 text-left rounded-tl-xl">‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th class="px-4 py-2 text-left">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
                    <th class="px-4 py-2 text-center rounded-tr-xl">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πà‡∏ô</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-100">
                  ${users.map(user => {
                    const playCount = history.filter(h => h.email === user.email).length;
                    return `
                      <tr class="hover:bg-gray-50">
                        <td class="px-4 py-2">${user.name}</td>
                        <td class="px-4 py-2 text-gray-500">${user.email}</td>
                        <td class="px-4 py-2 text-center font-medium">${playCount}</td>
                      </tr>
                    `;
                  }).join('') || `
                    <tr>
                      <td colspan="3" class="px-4 py-4 text-center text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</td>
                    </tr>
                  `}
                </tbody>
              </table>
            </div>
          </div>

          <div>
            <h3 class="text-lg font-bold text-gray-800 mb-3">‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
            <div class="space-y-3">
              ${lastPlays.map(play => `
                <div class="p-4 rounded-2xl bg-gray-50 flex items-center justify-between">
                  <div>
                    <p class="font-medium text-gray-800">${play.name}</p>
                    <p class="text-sm text-gray-500">${play.game_name} ¬∑ ${play.level}</p>
                  </div>
                  <div class="text-right">
                    <p class="font-bold text-indigo-600">${play.score}</p>
                    <p class="text-xs text-gray-400">${play.played_at}</p>
                  </div>
                </div>
              `).join('') || `
                <div class="p-4 rounded-2xl bg-gray-50 text-center text-gray-400">
                  ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô
                </div>
              `}
            </div>
          </div>

          <button onclick="closeModal()" class="w-full mt-6 py-3 bg-gray-100 text-gray-700 font-medium rounded-xl hover:bg-gray-200 transition-colors">
            ‡∏õ‡∏¥‡∏î
          </button>
        </div>
      `;
      showModal(content, 'admin-panel-modal');
    }

    // ==================== Toast Notification ====================
    function showToast(message, type = 'info') {
      const colors = {
        success: 'bg-green-500',
        error: 'bg-red-500',
        warning: 'bg-yellow-500',
        info: 'bg-indigo-500'
      };
      
      const toast = document.createElement('div');
      toast.className = `fixed top-24 left-1/2 -translate-x-1/2 ${colors[type]} text-white px-6 py-3 rounded-full shadow-lg z-50 animate-in`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => toast.remove(), 3000);
    }

    // ==================== Menu Functions ====================
    function openMenu() {
      document.getElementById('menu-overlay').classList.remove('hidden');
      document.getElementById('menu-popup').classList.add('active');
    }

    function closeMenu() {
      document.getElementById('menu-overlay').classList.add('hidden');
      document.getElementById('menu-popup').classList.remove('active');
    }

    // ==================== Render Games ====================
    function renderGames() {
      const container = document.getElementById('games-container');
      const data = gameData[currentCategory];
      
      const games = [
        { id: 'typing', name: '‡πÄ‡∏Å‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå', icon: '‚å®Ô∏è', desc: '‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ', questions: 10, color: 'from-blue-400 to-blue-600' },
        { id: 'quiz', name: '‡πÄ‡∏Å‡∏°‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°', icon: '‚ùì', desc: '‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏õ‡∏£‡∏ô‡∏±‡∏¢ 4 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å', questions: 10, color: 'from-green-400 to-green-600' },
        { id: 'matching', name: '‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà', icon: 'üîó', desc: '‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠', questions: 6, color: 'from-purple-400 to-purple-600' },
        { id: 'scenario', name: '‡πÄ‡∏Å‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå', icon: 'üìã', desc: '‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå', questions: 10, color: 'from-orange-400 to-orange-600' }
      ];
      
      container.innerHTML = games.map(game => `
        <div class="game-card bg-white rounded-3xl shadow-xl overflow-hidden" onclick="startGame('${game.id}')">
          <div class="bg-gradient-to-r ${game.color} p-6">
            <span class="text-5xl">${game.icon}</span>
          </div>
          <div class="p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-2">${game.name}</h3>
            <p class="text-gray-500 mb-4">${game.desc}</p>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-400">${game.questions} ‡∏Ç‡πâ‡∏≠</span>
              <span class="px-4 py-2 bg-gradient-to-r ${game.color} text-white text-sm font-bold rounded-full">
                ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏¢ ‚Üí
              </span>
            </div>
          </div>
        </div>
      `).join('');
    }

    // ==================== Start Game ====================
    function startGame(gameType) {
      if (!currentUser) {
        showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°', 'warning');
        showLoginModal();
        return;
      }
      
      currentGame = gameType;
      gameState = {
        currentQuestion: 0,
        score: 0,
        answers: []
      };
      
      switch(gameType) {
        case 'typing':
          renderTypingGame();
          break;
        case 'quiz':
          renderQuizGame();
          break;
        case 'matching':
          renderMatchingGame();
          break;
        case 'scenario':
          renderScenarioGame();
          break;
      }
    }

    // ==================== Typing Game ====================
    function renderTypingGame() {
      const data = gameData[currentCategory].typing;
      const current = data[gameState.currentQuestion];
      
      const content = `
        <div class="p-8">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
              <span class="text-3xl">‚å®Ô∏è</span>
              <div>
                <h2 class="text-xl font-bold text-gray-800">‡πÄ‡∏Å‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</h2>
                <p class="text-sm text-gray-500">${gameData[currentCategory].name}</p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-2xl font-bold text-indigo-600">${gameState.currentQuestion + 1}/10</p>
              <p class="text-sm text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${gameState.score}</p>
            </div>
          </div>
          
          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 text-center mb-6">
            <p class="text-sm text-gray-500 mb-4">‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ:</p>
            <p class="text-4xl font-mono font-bold text-indigo-700 tracking-wider mb-4">${current.hint}</p>
            <p class="text-sm text-gray-400">üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ: ${current.desc}</p>
          </div>
          
          <div class="space-y-4">
            <input type="text" id="typing-answer" 
              class="w-full px-6 py-4 text-center text-2xl font-bold border-3 border-indigo-200 rounded-2xl focus:border-indigo-500 focus:outline-none transition-colors uppercase"
              placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö..."
              autocomplete="off">
            
            <div id="typing-feedback" class="hidden text-center p-4 rounded-xl"></div>
            
            <button onclick="checkTypingAnswer()" id="typing-submit"
              class="w-full py-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold rounded-xl hover:opacity-90 transition-opacity">
              ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
            </button>
          </div>
          
          <button onclick="closeModal()" class="w-full mt-4 py-3 text-gray-500 hover:text-gray-700 transition-colors">
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°
          </button>
        </div>
      `;
      showGameModal(content);
      
      document.getElementById('typing-answer').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') checkTypingAnswer();
      });
      document.getElementById('typing-answer').focus();
    }

    function checkTypingAnswer() {
      const data = gameData[currentCategory].typing;
      const current = data[gameState.currentQuestion];
      const answer = document.getElementById('typing-answer').value.trim().toUpperCase();
      const feedback = document.getElementById('typing-feedback');
      const btn = document.getElementById('typing-submit');
      
      if (!answer) return;
      
      btn.disabled = true;
      
      const isCorrect = answer === current.answer;
      if (isCorrect) {
        gameState.score++;
        feedback.className = 'text-center p-4 rounded-xl bg-green-100 text-green-700';
        feedback.innerHTML = '‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!';
      } else {
        feedback.className = 'text-center p-4 rounded-xl bg-red-100 text-red-700';
        feedback.innerHTML = `‚ùå ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠: <strong>${current.answer}</strong>`;
      }
      feedback.classList.remove('hidden');
      
      setTimeout(() => {
        gameState.currentQuestion++;
        if (gameState.currentQuestion < 10) {
          renderTypingGame();
        } else {
          showGameResult();
        }
      }, 1500);
    }

    // ==================== Quiz Game ====================
    function renderQuizGame() {
      const data = gameData[currentCategory].quiz;
      const current = data[gameState.currentQuestion];
      
      const content = `
        <div class="p-8">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
              <span class="text-3xl">‚ùì</span>
              <div>
                <h2 class="text-xl font-bold text-gray-800">‡πÄ‡∏Å‡∏°‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</h2>
                <p class="text-sm text-gray-500">${gameData[currentCategory].name}</p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-2xl font-bold text-indigo-600">${gameState.currentQuestion + 1}/10</p>
              <p class="text-sm text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${gameState.score}</p>
            </div>
          </div>
          
          <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-6 mb-6">
            <p class="text-lg font-medium text-gray-800">${current.q}</p>
          </div>
          
          <div id="quiz-choices" class="grid grid-cols-1 gap-3">
            ${current.choices.map((choice, i) => `
              <button onclick="checkQuizAnswer(${i})" 
                class="quiz-choice p-4 text-left border-2 border-gray-200 rounded-xl hover:border-indigo-400 hover:bg-indigo-50 transition-all font-medium">
                <span class="inline-flex items-center justify-center w-8 h-8 bg-gray-100 rounded-full mr-3 text-sm font-bold">
                  ${['‡∏Å', '‡∏Ç', '‡∏Ñ', '‡∏á'][i]}
                </span>
                ${choice}
              </button>
            `).join('')}
          </div>
          
          <button onclick="closeModal()" class="w-full mt-6 py-3 text-gray-500 hover:text-gray-700 transition-colors">
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°
          </button>
        </div>
      `;
      showGameModal(content);
    }

    function checkQuizAnswer(selected) {
      const data = gameData[currentCategory].quiz;
      const current = data[gameState.currentQuestion];
      const buttons = document.querySelectorAll('.quiz-choice');
      
      buttons.forEach(btn => btn.disabled = true);
      
      const isCorrect = selected === current.answer;
      if (isCorrect) {
        gameState.score++;
        buttons[selected].classList.add('correct-answer');
      } else {
        buttons[selected].classList.add('wrong-answer');
        buttons[current.answer].classList.add('correct-answer');
      }
      
      setTimeout(() => {
        gameState.currentQuestion++;
        if (gameState.currentQuestion < 10) {
          renderQuizGame();
        } else {
          showGameResult();
        }
      }, 1200);
    }

    // ==================== Matching Game ====================
    function renderMatchingGame() {
      const data = gameData[currentCategory].matching;
      gameState.matchedPairs = 0;
      gameState.selectedLeft = null;
      gameState.selectedRight = null;
      
      // Shuffle right side
      const shuffledRight = [...data].sort(() => Math.random() - 0.5);
      
      const content = `
        <div class="p-8">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
              <span class="text-3xl">üîó</span>
              <div>
                <h2 class="text-xl font-bold text-gray-800">‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà</h2>
                <p class="text-sm text-gray-500">${gameData[currentCategory].name}</p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-2xl font-bold text-indigo-600">${gameState.score}/6</p>
              <p class="text-sm text-gray-500">‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
            </div>
          </div>
          
          <p class="text-center text-gray-500 mb-6">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤</p>
          
          <div class="grid grid-cols-2 gap-8">
            <div class="space-y-3">
              ${data.map((item, i) => `
                <button onclick="selectLeft(${i})" id="left-${i}"
                  class="match-left w-full p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border-2 border-transparent hover:border-purple-300 transition-all flex items-center gap-3">
                  <span class="text-3xl">${item.left}</span>
                  <span class="text-sm text-gray-500">${item.leftLabel}</span>
                </button>
              `).join('')}
            </div>
            <div class="space-y-3">
              ${shuffledRight.map((item, i) => `
                <button onclick="selectRight('${item.right}')" id="right-${item.right}"
                  class="match-right w-full p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border-2 border-transparent hover:border-indigo-300 transition-all text-left font-medium">
                  ${item.right}
                </button>
              `).join('')}
            </div>
          </div>
          
          <button onclick="closeModal()" class="w-full mt-6 py-3 text-gray-500 hover:text-gray-700 transition-colors">
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°
          </button>
        </div>
      `;
      showGameModal(content);
    }

    function selectLeft(index) {
      document.querySelectorAll('.match-left').forEach(btn => btn.classList.remove('matching-selected'));
      const btn = document.getElementById(`left-${index}`);
      if (!btn.classList.contains('matching-matched')) {
        btn.classList.add('matching-selected');
        gameState.selectedLeft = index;
        checkMatch();
      }
    }

    function selectRight(name) {
      document.querySelectorAll('.match-right').forEach(btn => btn.classList.remove('matching-selected'));
      const btn = document.getElementById(`right-${name}`);
      if (!btn.classList.contains('matching-matched')) {
        btn.classList.add('matching-selected');
        gameState.selectedRight = name;
        checkMatch();
      }
    }

    function checkMatch() {
      if (gameState.selectedLeft !== null && gameState.selectedRight !== null) {
        const data = gameData[currentCategory].matching;
        const leftItem = data[gameState.selectedLeft];
        
        const leftBtn = document.getElementById(`left-${gameState.selectedLeft}`);
        const rightBtn = document.getElementById(`right-${gameState.selectedRight}`);
        
        if (leftItem.right === gameState.selectedRight) {
          // Correct match
          gameState.score++;
          gameState.matchedPairs++;
          
          leftBtn.classList.add('matching-matched', 'correct-answer');
          rightBtn.classList.add('matching-matched', 'correct-answer');
          leftBtn.classList.remove('matching-selected');
          rightBtn.classList.remove('matching-selected');
          
          // Update score display
          document.querySelector('.text-2xl.font-bold.text-indigo-600').textContent = `${gameState.score}/6`;
          
          if (gameState.matchedPairs === 6) {
            setTimeout(showGameResult, 1000);
          }
        } else {
          // Wrong match
          leftBtn.classList.add('shake', 'wrong-answer');
          rightBtn.classList.add('shake', 'wrong-answer');
          
          setTimeout(() => {
            leftBtn.classList.remove('shake', 'wrong-answer', 'matching-selected');
            rightBtn.classList.remove('shake', 'wrong-answer', 'matching-selected');
          }, 500);
        }
        
        gameState.selectedLeft = null;
        gameState.selectedRight = null;
      }
    }

    // ==================== Scenario Game ====================
    function renderScenarioGame() {
      const data = gameData[currentCategory].scenario[gameState.currentQuestion];
      const shuffledSteps = [...data.steps].sort(() => Math.random() - 0.5);
      gameState.correctOrder = data.steps;
      gameState.currentOrder = shuffledSteps;
      
      const content = `
        <div class="p-8">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
              <span class="text-3xl">üìã</span>
              <div>
                <h2 class="text-xl font-bold text-gray-800">‡πÄ‡∏Å‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå</h2>
                <p class="text-sm text-gray-500">${gameData[currentCategory].name}</p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-2xl font-bold text-indigo-600">${gameState.currentQuestion + 1}/10</p>
              <p class="text-sm text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${gameState.score}</p>
            </div>
          </div>
          
          <div class="bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-4 mb-6">
            <p class="font-medium text-orange-800">üéØ ${data.title}</p>
            <p class="text-sm text-orange-600 mt-1">‡∏•‡∏≤‡∏Å‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
          </div>
          
          <div id="scenario-container" class="space-y-2">
            ${shuffledSteps.map((step, i) => `
              <div class="scenario-item flex items-center gap-3 p-4 bg-white border-2 border-gray-200 rounded-xl cursor-move hover:border-indigo-300 transition-all"
                draggable="true" data-step="${step}">
                <span class="flex-shrink-0 w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold text-sm">
                  ${i + 1}
                </span>
                <span class="text-gray-700">${step}</span>
                <span class="ml-auto text-gray-300">‚ãÆ‚ãÆ</span>
              </div>
            `).join('')}
          </div>
          
          <button onclick="checkScenarioAnswer()" 
            class="w-full mt-6 py-4 bg-gradient-to-r from-orange-500 to-amber-600 text-white font-bold rounded-xl hover:opacity-90 transition-opacity">
            ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
          </button>
          
          <button onclick="closeModal()" class="w-full mt-3 py-3 text-gray-500 hover:text-gray-700 transition-colors">
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°
          </button>
        </div>
      `;
      showGameModal(content);
      
      initDragAndDrop();
    }

    function initDragAndDrop() {
      const container = document.getElementById('scenario-container');
      const items = container.querySelectorAll('.scenario-item');
      let draggedItem = null;
      
      items.forEach(item => {
        item.addEventListener('dragstart', (e) => {
          draggedItem = item;
          item.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
        });
        
        item.addEventListener('dragend', () => {
          item.classList.remove('dragging');
          draggedItem = null;
          updateNumbers();
        });
        
        item.addEventListener('dragover', (e) => {
          e.preventDefault();
          if (draggedItem && draggedItem !== item) {
            const rect = item.getBoundingClientRect();
            const midY = rect.top + rect.height / 2;
            if (e.clientY < midY) {
              container.insertBefore(draggedItem, item);
            } else {
              container.insertBefore(draggedItem, item.nextSibling);
            }
          }
        });
        
        item.addEventListener('dragenter', (e) => {
          e.preventDefault();
          if (draggedItem !== item) {
            item.classList.add('drag-over');
          }
        });
        
        item.addEventListener('dragleave', () => {
          item.classList.remove('drag-over');
        });
        
        item.addEventListener('drop', () => {
          item.classList.remove('drag-over');
        });
      });
    }

    function updateNumbers() {
      const items = document.querySelectorAll('.scenario-item');
      items.forEach((item, i) => {
        item.querySelector('span:first-child').textContent = i + 1;
      });
    }

    function checkScenarioAnswer() {
      const items = document.querySelectorAll('.scenario-item');
      const currentOrder = Array.from(items).map(item => item.dataset.step);
      
      let isCorrect = true;
      currentOrder.forEach((step, i) => {
        if (step === gameState.correctOrder[i]) {
          items[i].classList.add('correct-answer');
        } else {
          items[i].classList.add('wrong-answer');
          isCorrect = false;
        }
      });
      
      if (isCorrect) {
        gameState.score++;
      }
      
      setTimeout(() => {
        gameState.currentQuestion++;
        if (gameState.currentQuestion < 10) {
          renderScenarioGame();
        } else {
          showGameResult();
        }
      }, 1500);
    }

    // ==================== Game Result ====================
    async function showGameResult() {
      const gameNames = {
        typing: '‡πÄ‡∏Å‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå',
        quiz: '‡πÄ‡∏Å‡∏°‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°',
        matching: '‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà',
        scenario: '‡πÄ‡∏Å‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå'
      };
      
      const maxScore = currentGame === 'matching' ? 6 : 10;
      const percentage = Math.round((gameState.score / maxScore) * 100);
      
      let emoji, message, color;
      if (percentage >= 80) {
        emoji = 'üèÜ';
        message = '‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!';
        color = 'from-yellow-400 to-amber-500';
      } else if (percentage >= 60) {
        emoji = '‚≠ê';
        message = '‡∏î‡∏µ‡∏°‡∏≤‡∏Å!';
        color = 'from-green-400 to-emerald-500';
      } else if (percentage >= 40) {
        emoji = 'üí™';
        message = '‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ!';
        color = 'from-blue-400 to-indigo-500';
      } else {
        emoji = 'üìö';
        message = '‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á!';
        color = 'from-purple-400 to-pink-500';
      }
      
      // Save history
      if (allData.length < 999) {
        await window.dataSdk.create({
          user_type: 'history',
          email: currentUser.email,
          name: currentUser.name,
          password: '',
          game_name: gameNames[currentGame],
          level: gameData[currentCategory].name,
          score: gameState.score,
          played_at: new Date().toLocaleDateString('th-TH')
        });
      }
      
      const content = `
        <div class="p-8 text-center">
          <div class="text-8xl mb-4">${emoji}</div>
          <h2 class="text-3xl font-bold text-gray-800 mb-2">${message}</h2>
          <p class="text-gray-500 mb-6">${gameNames[currentGame]} - ${gameData[currentCategory].name}</p>
          
          <div class="bg-gradient-to-r ${color} rounded-2xl p-8 mb-8">
            <p class="text-white text-lg mb-2">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
            <p class="text-6xl font-bold text-white">${gameState.score}/${maxScore}</p>
            <p class="text-white/80 mt-2">${percentage}%</p>
          </div>
          
          <div class="grid grid-cols-2 gap-4">
            <button onclick="startGame('${currentGame}')" 
              class="py-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold rounded-xl hover:opacity-90 transition-opacity">
              üîÑ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
            </button>
            <button onclick="closeModal()" 
              class="py-4 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors">
              üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
          </div>
        </div>
      `;
      showGameModal(content, 'result-modal');
    }

    // ==================== Event Listeners ====================
    function initEventListeners() {
      // Menu
      document.getElementById('menu-btn').addEventListener('click', openMenu);
      document.getElementById('close-menu').addEventListener('click', closeMenu);
      document.getElementById('menu-overlay').addEventListener('click', closeMenu);
      
      // Menu buttons
      document.getElementById('btn-register').addEventListener('click', showRegisterModal);
      document.getElementById('btn-login').addEventListener('click', showLoginModal);
      document.getElementById('btn-history').addEventListener('click', showHistoryModal);
      document.getElementById('btn-how-to-play').addEventListener('click', showHowToPlay);
      document.getElementById('btn-developer').addEventListener('click', showDeveloperModal);
      document.getElementById('btn-logout').addEventListener('click', handleLogout);
      document.getElementById('btn-admin-login').addEventListener('click', showAdminLoginModal);
      document.getElementById('btn-admin-panel').addEventListener('click', showAdminPanel);
      
      // Category tabs
      document.querySelectorAll('.category-tab').forEach(tab => {
        tab.addEventListener('click', () => {
          document.querySelectorAll('.category-tab').forEach(t => {
            t.classList.remove('tab-active');
            t.classList.add('text-gray-600');
          });
          tab.classList.add('tab-active');
          tab.classList.remove('text-gray-600');
          currentCategory = tab.dataset.category;
          renderGames();
        });
      });
    }

    // ==================== Initialize ====================
    async function init() {
      await initElementSdk();
      
      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) {
          console.error('Failed to initialize Data SDK');
        }
      }
      
      initEventListeners();
      renderGames();
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cb322d0e5fb55a1',t:'MTc3MDYzNzY4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
